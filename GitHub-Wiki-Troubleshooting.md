# トラブルシューティング

この包括的なトラブルシューティングガイドは、BrowserChooser3の一般的な問題を解決するのに役立ちます。

## 🚨 クイック診断

### デバッグログの有効化
まず、問題の詳細情報を取得するためにログを有効にしてください：

```bash
BrowserChooser3.exe --log
```

これにより、問題の診断に役立つ詳細なログファイルを含む`Logs/`フォルダが作成されます。

### システム要件の確認
システムが最小要件を満たしていることを確認してください：
- Windows 10（1903以降）またはWindows 11
- .NET 8.0 Runtimeがインストール済み
- x64アーキテクチャ
- 100 MBの利用可能RAM

## 🔧 よくある問題

### アプリケーションが起動しない

#### 問題: "アプリケーションの開始に失敗しました"または".NET Frameworkが見つかりません"
**症状**: .NETが見つからないエラーメッセージまたはアプリケーションが起動しない
**解決策**:
1. **.NET 8.0 Runtimeをインストール**:
   - [Microsoft .NET ダウンロード](https://dotnet.microsoft.com/download/dotnet/8.0)からダウンロード
   - Windows x64用の"Runtime"（SDKではない）を選択
   - インストーラーを実行し、コンピューターを再起動

2. **インストールを確認**:
   ```bash
   dotnet --version
   ```
   バージョン8.0.xが表示されるはずです

3. **アーキテクチャを確認**:
   - x64バージョンをダウンロードしたことを確認
   - システムが64ビットであることを確認

#### 問題: "ファイルが見つかりません"または"パスが見つかりません"
**症状**: ファイルまたはパスが見つからないエラー
**解決策**:
1. **ファイルの場所を確認**: すべてのファイルが同じフォルダにあることを確認
2. **権限を確認**: 必要に応じて管理者として実行
3. **アンチウイルスを確認**: 一部のアンチウイルスソフトウェアがアプリケーションをブロックする可能性があります

#### 問題: アプリケーションが起動するがすぐに閉じる
**症状**: BrowserChooser3が一瞬表示されてから消える
**解決策**:
1. **コマンドラインを確認**: エラーメッセージを確認するためにコマンドプロンプトから実行
2. **ログを有効化**: 起動エラーをキャプチャするために`--log`フラグを使用
3. **依存関係を確認**: 必要なファイルがすべて存在することを確認

### 透明化の問題

#### 問題: 透明化が動作しない
**症状**: 透明化設定にもかかわらずウィンドウが不透明に見える
**解決策**:
1. **Windows設定を確認**:
   - 設定 → 個人用設定 → 色に移動
   - "透明効果"が有効になっていることを確認
   - BrowserChooser3を再起動

2. **グラフィックドライバーを更新**:
   - グラフィックドライバーの更新を確認
   - ドライバー更新後に再起動

3. **異なる設定を試す**:
   - 透明化色を変更
   - 透明度値を調整
   - 異なる角の丸みでテスト

4. **.NETバージョンを確認**:
   - .NET 8.0がインストールされていることを確認
   - 必要に応じて.NETを再インストール

#### 問題: 角の丸みがギザギザに見える
**症状**: 角がピクセル化されているか滑らかでない
**解決策**:
1. **ハードウェアアクセラレーションを有効化**:
   - グラフィックドライバーを更新
   - Windowsグラフィック設定を確認

2. **DPI設定を調整**:
   - Windows DPIスケーリングを確認
   - 異なるDPI設定を試す

3. **角の丸みを減らす**:
   - より小さな半径値を使用
   - 半径5-10でテスト

### ブラウザ検出の問題

#### 問題: ブラウザが自動検出されない
**症状**: リストにブラウザが表示されない
**解決策**:
1. **手動でブラウザを追加**:
   - `O`キーを押してオプションを開く
   - "Browsers"タブに移動
   - "Add"をクリックして手動でブラウザを追加

2. **ブラウザのインストールを確認**:
   - ブラウザが適切にインストールされていることを確認
   - ブラウザが標準的な場所にあることを確認

3. **レジストリの問題**:
   - 一部のブラウザが適切に登録されていない可能性
   - 問題のあるブラウザを再インストール

#### 問題: カスタムブラウザが起動しない
**症状**: ブラウザがリストに表示されるが起動しない
**解決策**:
1. **パスを確認**: 実行ファイルのパスが正しいことを確認
2. **引数を確認**: 起動引数が有効であることを確認
3. **手動でテスト**: 同じ引数でブラウザを手動実行
4. **権限を確認**: BrowserChooser3がブラウザを起動する権限があることを確認

### パフォーマンスの問題

#### 問題: 起動が遅いまたはCPU使用率が高い
**症状**: アプリケーションの起動に時間がかかるか、過度のCPUを使用する
**解決策**:
1. **透明化を無効化**: 一時的に透明化効果を無効にする
2. **角の丸みを減らす**: より小さな角の丸み値を使用
3. **バックグラウンドプロセスを確認**: 不要なバックグラウンドアプリケーションを閉じる
4. **グラフィックドライバーを更新**: ドライバーが最新であることを確認

#### 問題: メモリ使用量が増え続ける
**症状**: メモリ使用量が時間とともに増加する
**解決策**:
1. **アプリケーションを再起動**: BrowserChooser3を閉じて再起動
2. **メモリリークを確認**: タスクマネージャーで監視
3. **問題を報告**: メモリ使用量の詳細でGitHub issueを作成

### 設定の問題

#### 問題: 設定が保存されない
**症状**: 設定の変更が再起動後に失われる
**解決策**:
1. **ファイル権限を確認**: 設定ファイルへの書き込みアクセスを確認
2. **ファイルの場所を確認**: `BrowserChooser3Config.xml`が正しい場所にあることを確認
3. **管理者として実行**: 管理者権限で実行を試す

#### 問題: 設定ファイルが破損している
**症状**: アプリケーションが起動しないかエラーが表示される
**解決策**:
1. **バックアップして削除**: `BrowserChooser3Config.xml`をリネームまたは削除
2. **アプリケーションを再起動**: BrowserChooser3が新しい設定ファイルを作成
3. **設定を復元**: 設定を手動で再構成

### 表示の問題

#### 問題: ウィンドウが間違った場所に表示される
**症状**: ウィンドウが画面外または予期しない位置で開く
**解決策**:
1. **位置をリセット**: 設定ファイルを削除してウィンドウ位置をリセット
2. **複数モニターを確認**: ウィンドウが切断されたモニターにないことを確認
3. **Alt+Tabを使用**: Alt+Tabでウィンドウを前面に表示

#### 問題: テキストがぼやけているかピクセル化されている
**症状**: テキストが読みにくいかぼやけて見える
**解決策**:
1. **DPI設定を確認**: Windows DPIスケーリングを調整
2. **グラフィックドライバーを更新**: ドライバーが高DPIをサポートしていることを確認
3. **透明化を無効化**: 透明化効果なしで試す

## 🔍 高度なトラブルシューティング

### ログ分析

#### 詳細ログの有効化
```bash
BrowserChooser3.exe --log
```

#### 主要ログファイル
- `BrowserChooser3.log`: メインアプリケーションログ
- `Startup.log`: 起動と初期化ログ
- `Error.log`: エラー専用ログ

#### 一般的なログメッセージ
- `"Application started"`: 正常な起動
- `"Transparency settings applied"`: 透明化が動作中
- `"Browser detected"`: ブラウザ検出が動作中
- `"Configuration loaded"`: 設定が正常に読み込まれた

### レジストリの問題

#### ブラウザ登録の確認
```bash
reg query "HKEY_CLASSES_ROOT\http\shell\open\command"
reg query "HKEY_CLASSES_ROOT\https\shell\open\command"
```

#### ブラウザ関連付けのリセット
1. 設定 → アプリ → 既定のアプリを開く
2. 既定のブラウザを選択
3. BrowserChooser3を再起動

### ネットワークの問題

#### 問題: URLが開かない
**症状**: ブラウザボタンをクリックしてもURLが開かない
**解決策**:
1. **URL形式を確認**: URLが`http://`または`https://`で始まることを確認
2. **ブラウザをテスト**: ブラウザで直接URLを開いてみる
3. **ファイアウォールを確認**: ファイアウォールがアプリケーションをブロックしていないことを確認
4. **アンチウイルスを確認**: 一部のアンチウイルスソフトウェアがURLの開封をブロックする可能性

## 🛠️ 診断ツール

### 内蔵診断
BrowserChooser3にはいくつかの診断機能が含まれています：

#### システム情報
- `O`キーを押してオプションを開く
- "Other"タブでシステム情報を確認
- .NETバージョンとシステム詳細を確認

#### ブラウザ検出テスト
- オプションの"Browsers"タブに移動
- "Detect Browsers"をクリックして検出をテスト
- ブラウザが見つかるかどうかを確認

### 外部ツール

#### Process Monitor
Process Monitorを使用してファイルとレジストリアクセスを追跡：
1. MicrosoftからProcess Monitorをダウンロード
2. Process Monitorと一緒にBrowserChooser3を実行
3. アクセス拒否エラーを探す

#### Dependency Walker
Dependency Walkerを使用して不足しているDLLを確認：
1. Dependency Walkerをダウンロード
2. BrowserChooser3.exeを開く
3. 不足している依存関係を確認

## 📞 ヘルプの取得

### ヘルプを求める前に
1. **ログを有効化**: `--log`フラグを使用
2. **このガイドを確認**: 類似の問題を探す
3. **GitHub Issuesを検索**: 既存の報告を確認
4. **情報を収集**: システム詳細とエラーメッセージを収集

### 含めるべき情報
問題を報告する際は、以下を含めてください：
- **Windowsバージョン**: Windows 10/11バージョン
- **.NETバージョン**: `dotnet --version`の出力
- **エラーメッセージ**: 正確なエラーテキスト
- **再現手順**: 問題を引き起こす方法
- **ログファイル**: 関連するログエントリ
- **システム仕様**: CPU、RAM、グラフィックカード

### 問題の報告
1. **GitHub Issues**: GitHubで新しいissueを作成
2. **ログを含める**: 関連するログファイルを添付
3. **具体的に**: 詳細な情報を提供
4. **解決策をテスト**: 提案された解決策を試して結果を報告

## 🔄 復旧手順

### 完全リセット
他のすべてが失敗した場合、完全リセットを実行：

1. **BrowserChooser3を閉じる**
2. **設定ファイルを削除**: `BrowserChooser3Config.xml`を削除
3. **ログファイルを削除**: `Logs/`フォルダを削除
4. **アプリケーションを再起動**: BrowserChooser3を起動
5. **設定を再構成**: 設定を再度セットアップ

### 部分リセット
特定の問題については、部分リセットを試してください：

#### 透明化設定のリセット
1. オプションダイアログを開く
2. Displayタブに移動
3. 透明化を無効にする
4. アプリケーションを再起動
5. デフォルト設定で透明化を再有効化

#### ブラウザ設定のリセット
1. オプションダイアログを開く
2. Browsersタブに移動
3. すべてのブラウザを削除
4. "Detect Browsers"をクリック
5. 不足しているブラウザを手動で追加

## 📚 関連リソース

- [インストールガイド](Installation-Guide)
- [設定ガイド](Configuration-Guide)
- [透明化設定](Transparency-Settings)
- [アクセシビリティ機能](Accessibility-Features)

---

*ここで解決策が見つからない場合は、問題の詳細情報とともに[GitHub issueを作成](https://github.com/Yosuke-Sh/BrowserChooser3/issues)してください。*

