# トラブルシューティング

BrowserChooser3で発生する可能性のある問題とその解決方法を説明します。

## 🚨 よくある問題

### アプリケーションが起動しない

#### 症状
- アプリケーションが起動しない
- エラーメッセージが表示される
- プロセスが開始されない

#### 原因と解決策

**1. .NET 8.0 Runtimeがインストールされていない**
```cmd
# .NET 8.0 Runtimeの確認
dotnet --list-runtimes

# インストールされていない場合
# https://dotnet.microsoft.com/download/dotnet/8.0 からダウンロード
```

**2. ファイルが破損している**
```cmd
# ファイルの整合性を確認
# アプリケーションを再ダウンロード
```

**3. 権限の問題**
```cmd
# 管理者権限で実行
# または、ポータブル版を使用
```

**4. アンチウイルスソフトの誤検知**
- アンチウイルスソフトの除外リストに追加
- リアルタイム保護を一時的に無効化

### ブラウザが検出されない

#### 症状
- ブラウザ選択画面にブラウザが表示されない
- 自動検出されたブラウザが少ない
- 手動追加したブラウザが表示されない

#### 原因と解決策

**1. ブラウザが非標準の場所にインストールされている**
```cmd
# ブラウザのパスを確認
# 手動でブラウザを追加
```

**2. レジストリ情報が破損している**
```cmd
# ブラウザを再インストール
# または、手動でブラウザを追加
```

**3. ブラウザが正しくインストールされていない**
```cmd
# ブラウザを再インストール
# インストール後にアプリケーションを再起動
```

### 透明化が動作しない

#### 症状
- ウィンドウが透明にならない
- 透明化設定が反映されない
- 角の丸みが表示されない

#### 原因と解決策

**1. Windows透明化効果が無効**
```cmd
# Windows設定 > 個人用設定 > 色 > 透明効果を有効化
# または、レジストリで確認
reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\DWM" /v EnableAeroPeek
```

**2. グラフィックドライバーが古い**
```cmd
# グラフィックドライバーを更新
# ハードウェアアクセラレーションを有効化
```

**3. .NET 8.0の問題**
```cmd
# .NET 8.0を再インストール
# または、アプリケーションを再インストール
```

### システムトレイに表示されない

#### 症状
- システムトレイアイコンが表示されない
- システムトレイ常駐が動作しない
- アイコンが非表示になっている

#### 原因と解決策

**1. システムトレイの設定**
```cmd
# システムトレイの設定を確認
# アイコンを表示するように設定
```

**2. アプリケーションが正常に起動していない**
```cmd
# アプリケーションを再起動
# ログを確認
```

**3. 設定の問題**
```cmd
# 設定ファイルを確認
# または、設定をリセット
```

### 設定が保存されない

#### 症状
- 設定が保存されない
- 設定がリセットされる
- 設定ファイルが作成されない

#### 原因と解決策

**1. 権限の問題**
```cmd
# アプリケーションフォルダの権限を確認
# 管理者権限で実行
```

**2. ディスク容量不足**
```cmd
# ディスク容量を確認
# 不要なファイルを削除
```

**3. 設定ファイルの破損**
```cmd
# 設定ファイルを削除して再作成
# または、バックアップから復元
```

## 🔍 デバッグ方法

### ログの有効化

#### ログの設定
1. オプションダイアログを開く（`O`キー）
2. 「Other」タブを選択
3. 「Enable Logging」をチェック
4. ログレベルを選択

#### ログファイルの確認
```cmd
# ログファイルの場所
Logs/BrowserChooser3.log

# ログファイルの内容を確認
type Logs\BrowserChooser3.log
```

#### ログレベルの説明
- **Info**: 一般的な情報
- **Warning**: 警告メッセージ
- **Error**: エラーメッセージ
- **Debug**: デバッグ情報

### コマンドラインでのデバッグ

#### デバッグモードで起動
```cmd
# デバッグモードで起動
BrowserChooser3.exe --debug

# ログとデバッグを同時に有効化
BrowserChooser3.exe --debug --log
```

#### 詳細なエラー情報
```cmd
# 詳細なエラー情報を表示
BrowserChooser3.exe --verbose

# 設定ファイルのパスを指定
BrowserChooser3.exe --config "C:\Path\To\Config.xml"
```

### 設定ファイルの確認

#### 設定ファイルの場所
```cmd
# 設定ファイルの場所
BrowserChooser3Config.xml

# 設定ファイルの内容を確認
type BrowserChooser3Config.xml
```

#### 設定ファイルの検証
```cmd
# XML構文エラーをチェック
# XMLエディタで開く
# または、オンラインXMLバリデーターを使用
```

## 🛠️ 高度なトラブルシューティング

### パフォーマンス問題

#### 症状
- アプリケーションが遅い
- メモリ使用量が高い
- CPU使用率が高い

#### 解決策

**1. 透明化設定の調整**
```xml
<!-- 透明化を無効化または軽減 -->
<Transparency>0.95</Transparency>
<CornerRadius>0</CornerRadius>
```

**2. 不要なブラウザを削除**
```cmd
# 使用しないブラウザを削除
# ブラウザの数を最小限に保つ
```

**3. システムリソースの確認**
```cmd
# タスクマネージャーでリソース使用量を確認
# 他のアプリケーションを終了
```

### メモリリーク

#### 症状
- メモリ使用量が徐々に増加
- 長時間使用後に動作が遅くなる
- アプリケーションがクラッシュする

#### 解決策

**1. アプリケーションの再起動**
```cmd
# 定期的にアプリケーションを再起動
# または、システムトレイ常駐を有効化
```

**2. ログファイルの確認**
```cmd
# ログファイルのサイズを確認
# 必要に応じてログを削除
```

**3. 設定の最適化**
```xml
<!-- メモリ使用量を最適化 -->
<EnableLogging>false</EnableLogging>
<DebugMode>false</DebugMode>
```

### ネットワーク問題

#### 症状
- ブラウザ検出が失敗する
- プロトコルハンドラーが動作しない
- ネットワーク関連のエラーが発生

#### 解決策

**1. ファイアウォール設定**
```cmd
# ファイアウォールでアプリケーションを許可
# または、ファイアウォールを一時的に無効化
```

**2. プロキシ設定**
```cmd
# プロキシ設定を確認
# 必要に応じてプロキシ設定を調整
```

**3. DNS設定**
```cmd
# DNS設定を確認
# 必要に応じてDNSサーバーを変更
```

## 🔍 AutoURLsとProtocol機能のトラブルシューティング

### AutoURLs関連の問題

#### AutoURLsが動作しない
**症状**: 設定したURLパターンにマッチしても自動起動しない

**原因と対処法**:
1. **URLパターンの問題**
   - パターンに`@`プレフィックスが付いているか確認
   - ワイルドカード`*`が正しく使用されているか確認

2. **ブラウザ設定の問題**
   - 指定したブラウザが正しく設定されているか確認
   - ブラウザのGUIDが正しく保存されているか確認

3. **Active設定の問題**
   - AutoURLsのActiveがチェックされているか確認

**確認方法**:
```cmd
# ログレベルをTraceに設定して詳細ログを確認
# ログで「AutoURLマッチング成功」のメッセージを確認
```

#### 遅延起動が動作しない
**症状**: 遅延時間を設定しても即座に起動する

**原因と対処法**:
1. **Delay設定の問題**
   - Delayに正しい数値が設定されているか確認
   - 空欄の場合は設定画面のデフォルト遅延時間を使用

2. **デフォルト遅延時間の問題**
   - 設定画面の「Others」タブでデフォルト遅延時間が設定されているか確認

#### 自動終了しない
**症状**: ブラウザ起動後にアプリケーションが閉じない

**原因と対処法**:
1. **メイン画面の設定**
   - 「ブラウザを選択後に自動的に閉じる」がチェックされているか確認

2. **ログの確認**
   - ログで「AutoClose実行」のメッセージが出力されているか確認

### Protocol関連の問題

#### Protocolが動作しない
**症状**: 設定したプロトコルでURLを開いても動作しない

**原因と対処法**:
1. **Protocol Header設定の問題**
   - Protocol Headerが正しく設定されているか確認
   - 空欄になっていないか確認

2. **ブラウザ設定の問題**
   - 指定したブラウザが正しく設定されているか確認
   - ブラウザのGUIDが正しく保存されているか確認

3. **Active設定の問題**
   - ProtocolのActiveがチェックされているか確認

**確認方法**:
```cmd
# ログレベルをTraceに設定して詳細ログを確認
# ログで「Protocolマッチング成功」のメッセージを確認
```

#### URLが正しく渡されない
**症状**: Protocolでブラウザは起動するが、URLが渡されない

**原因と対処法**:
1. **URL処理の競合**
   - AutoURLsとProtocolの両方でマッチしている可能性
   - 優先順位を確認（AutoURLs > Protocol）

2. **ログの確認**
   - ログで「StartupLauncherはスキップ」のメッセージを確認
   - 処理順序が正しいか確認

### 優先順位の問題

#### 期待しない動作が発生する
**症状**: 設定した機能ではなく、別の機能が動作する

**原因と対処法**:
1. **優先順位の確認**
   - AutoURLs > Protocol > 通常処理の順序を理解
   - 複数の設定が競合していないか確認

2. **設定の見直し**
   - 不要な設定を無効化
   - 設定の優先順位を調整

## 📋 問題報告

### 報告に必要な情報

#### 基本情報
- **OS**: Windows 10/11のバージョン
- **アプリケーション**: BrowserChooser3のバージョン
- **.NET**: .NET 8.0のバージョン
- **アーキテクチャ**: x64/x86

#### 問題の詳細
- **症状**: 具体的な問題の説明
- **再現手順**: 問題を再現する手順
- **期待される動作**: 正常な動作の説明
- **実際の動作**: 実際に発生する動作

#### ログとエラー情報
- **ログファイル**: 関連するログの内容
- **エラーメッセージ**: 表示されるエラーメッセージ
- **スクリーンショット**: 問題のスクリーンショット

### 報告の方法

#### GitHub Issues
1. [GitHub Issues](https://github.com/Yosuke-Sh/BrowserChooser3/issues)にアクセス
2. 「New Issue」をクリック
3. 問題の詳細を記入
4. 必要な情報を添付

#### コミュニティフォーラム
1. [コミュニティフォーラム](https://github.com/Yosuke-Sh/BrowserChooser3/discussions)にアクセス
2. 新しいディスカッションを作成
3. 問題の詳細を記入

## 🔧 予防的メンテナンス

### 定期的なチェック

#### 設定ファイルのバックアップ
```cmd
# 設定ファイルを定期的にバックアップ
copy BrowserChooser3Config.xml BrowserChooser3Config_backup.xml
```

#### ログファイルの管理
```cmd
# ログファイルのサイズを確認
# 必要に応じて古いログを削除
```

#### システムの更新
```cmd
# Windows Updateを定期的に実行
# グラフィックドライバーを更新
# .NET 8.0を最新版に更新
```

### パフォーマンス最適化

#### 設定の最適化
```xml
<!-- パフォーマンスを重視した設定 -->
<Transparency>0.95</Transparency>
<CornerRadius>0</CornerRadius>
<EnableLogging>false</EnableLogging>
<DebugMode>false</DebugMode>
```

#### システムリソースの監視
```cmd
# タスクマネージャーでリソース使用量を監視
# 必要に応じてアプリケーションを再起動
```

## 📚 関連情報

- [設定ガイド](Configuration-Guide)
- [システム要件](System-Requirements)
- [インストールガイド](Installation-Guide)
- [FAQ](FAQ)

---

*他の問題や詳細な情報については、[GitHub Issues](https://github.com/Yosuke-Sh/BrowserChooser3/issues)をご覧ください。*
