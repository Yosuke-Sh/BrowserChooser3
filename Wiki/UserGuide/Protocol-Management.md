# プロトコル管理

BrowserChooser3でのプロトコル管理について詳しく説明します。

## 🌐 プロトコルとは

### プロトコルの定義
プロトコルは、URLの先頭部分で使用される通信方式を指定する文字列です。

### 一般的なプロトコル
| プロトコル | 説明 | 例 |
|-----------|------|-----|
| `http://` | 通常のWebページ | `http://example.com` |
| `https://` | 暗号化されたWebページ | `https://example.com` |
| `ftp://` | ファイル転送 | `ftp://ftp.example.com` |
| `mailto:` | メール送信 | `mailto:user@example.com` |
| `file://` | ローカルファイル | `file:///C:/path/file.html` |

## 🔧 プロトコルハンドラーの設定

### プロトコルハンドラーとは
プロトコルハンドラーは、特定のプロトコルに対して使用するブラウザを指定する機能です。

### 設定方法
1. オプションダイアログを開く（`O`キー）
2. 「Protocols」タブを選択
3. プロトコルハンドラーの設定を行う

## ➕ プロトコルハンドラーの追加

### 手動追加の手順
1. 「Protocols」タブを選択
2. 「Add」ボタンをクリック
3. 以下の情報を入力：

#### 必須項目
- **Protocol**: プロトコル名（例：`https`、`mailto`）
- **Browser**: 使用するブラウザを選択

#### オプション項目
- **Description**: プロトコルの説明（例：Secure Web Pages）

### プロトコル名の指定
プロトコル名は以下の形式で指定します：

#### 基本形式
```
プロトコル名（コロンなし）
```

#### 例
```
https
http
ftp
mailto
file
```

### ブラウザの選択
- 設定済みのブラウザ一覧から選択
- プロトコルごとに異なるブラウザを指定可能
- デフォルトブラウザを指定することも可能

## ✏️ プロトコルハンドラーの編集

### 編集手順
1. プロトコル一覧から編集したいプロトコルを選択
2. 「Edit」ボタンをクリック
3. 設定を変更
4. 「OK」をクリックして保存

### 編集可能項目
- **Protocol**: プロトコル名
- **Browser**: 使用するブラウザ
- **Description**: プロトコルの説明

## 🗑️ プロトコルハンドラーの削除

### 削除手順
1. プロトコル一覧から削除したいプロトコルを選択
2. 「Remove」ボタンをクリック
3. 確認ダイアログで「Yes」をクリック

### 削除の注意事項
- 削除したプロトコルハンドラーは完全に削除されます
- 削除後は再追加が必要です
- システムプロトコルは削除できません

## 🎯 プロトコルハンドラーの動作

### 動作の流れ
1. URLが入力される
2. プロトコル部分が解析される
3. 対応するプロトコルハンドラーが検索される
4. 指定されたブラウザでURLが開かれる

### 優先順位
1. プロトコルハンドラーで指定されたブラウザ
2. デフォルトブラウザ
3. ブラウザ選択画面での手動選択

### フォールバック
- プロトコルハンドラーが設定されていない場合
- 指定されたブラウザが見つからない場合
- ブラウザ選択画面が表示されます

## 🔧 高度な設定

### カスタムプロトコル
カスタムプロトコルを作成して、特定のアプリケーションを起動できます。

#### 例：カスタムプロトコル
```
myapp://open?file=document.txt
```

#### 設定方法
1. プロトコル名を`myapp`として追加
2. 対応するアプリケーションをブラウザとして指定
3. アプリケーションの引数に`{url}`を指定

### 複数プロトコルの設定
同じブラウザで複数のプロトコルを処理できます。

#### 例：Chromeで複数プロトコル
```
https -> Chrome
http -> Chrome
ftp -> Chrome
```

### プロトコル別の引数設定
プロトコルごとに異なるコマンドライン引数を設定できます。

#### 例：プロトコル別引数
```
https -> Chrome --new-window {url}
http -> Chrome --new-tab {url}
mailto -> Chrome --app={url}
```

## 🚨 トラブルシューティング

### よくある問題

#### プロトコルハンドラーが動作しない
**原因**:
- プロトコル名が正しくない
- 指定されたブラウザが見つからない
- ブラウザの引数が正しくない

**解決策**:
1. プロトコル名を確認
2. ブラウザの設定を確認
3. ブラウザの引数を確認

#### カスタムプロトコルが動作しない
**原因**:
- アプリケーションのパスが正しくない
- アプリケーションが対応していない
- 引数の形式が正しくない

**解決策**:
1. アプリケーションのパスを確認
2. アプリケーションの仕様を確認
3. 引数の形式を確認

#### プロトコルハンドラーが削除できない
**原因**:
- システムプロトコルである
- アプリケーションが使用中である

**解決策**:
1. システムプロトコルかどうか確認
2. アプリケーションを終了してから削除

### デバッグ方法

#### ログの確認
1. 「Other」タブでログを有効化
2. プロトコルハンドラーを使用
3. ログファイルを確認

#### 手動テスト
1. コマンドプロンプトで直接テスト
2. ブラウザの引数を確認
3. エラーメッセージを確認

## 💡 ベストプラクティス

### プロトコル命名規則
- 分かりやすい名前を使用
- 標準的なプロトコル名に従う
- カスタムプロトコルは明確な命名

### ブラウザ選択
- プロトコルの特性に適したブラウザを選択
- セキュリティを考慮したブラウザ選択
- パフォーマンスを考慮したブラウザ選択

### 設定管理
- 定期的にプロトコルハンドラーを見直し
- 不要なプロトコルハンドラーを削除
- 設定のバックアップを取る

## 📚 使用例

### 基本的な使用例

#### HTTPSプロトコル
```
Protocol: https
Browser: Chrome
Description: Secure Web Pages
```

#### HTTPプロトコル
```
Protocol: http
Browser: Firefox
Description: Web Pages
```

#### Mailtoプロトコル
```
Protocol: mailto
Browser: Outlook
Description: Email Links
```

### 高度な使用例

#### カスタムアプリケーション
```
Protocol: myapp
Browser: C:\Path\To\MyApp.exe
Arguments: --open {url}
Description: Custom Application
```

#### 複数ブラウザ
```
https -> Chrome
http -> Firefox
mailto -> Outlook
ftp -> FileZilla
```

#### プロトコル別引数
```
https -> Chrome --new-window {url}
http -> Chrome --new-tab {url}
mailto -> Chrome --app={url}
```

## 🔍 設定ファイル

### プロトコルハンドラーの保存
プロトコルハンドラーの設定は`BrowserChooser3Config.xml`に保存されます：

```xml
<ProtocolHandlers>
  <ProtocolHandler>
    <Protocol>https</Protocol>
    <Browser>Chrome</Browser>
    <Description>Secure Web Pages</Description>
  </ProtocolHandler>
  <ProtocolHandler>
    <Protocol>http</Protocol>
    <Browser>Firefox</Browser>
    <Description>Web Pages</Description>
  </ProtocolHandler>
</ProtocolHandlers>
```

### 設定ファイルの編集
- 設定ファイルを直接編集することも可能
- XML形式で保存
- アプリケーション再起動後に反映

## 🚀 今後の改善

### 予定されている機能
- プロトコル別の詳細設定
- プロトコルハンドラーのインポート/エクスポート
- プロトコル別のログ設定
- プロトコルハンドラーの優先順位設定

### 要望・提案
- 新しいプロトコルの追加
- プロトコルハンドラーの改善
- カスタムプロトコルの拡張

---

*より詳細な設定については、[設定ガイド](Configuration-Guide)をご覧ください。*
