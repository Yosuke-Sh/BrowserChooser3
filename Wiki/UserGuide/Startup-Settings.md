# 起動設定

BrowserChooser3の起動設定について詳しく説明します。

## 🚀 起動時の動作設定

### 起動モードの選択
「Startup」タブで以下の起動モードから選択できます：

#### Normal（通常起動）
- アプリケーションが通常のウィンドウで起動
- ブラウザ選択画面が表示される
- 最も一般的な起動モード

#### Start Minimized（最小化で起動）
- アプリケーションが最小化された状態で起動
- タスクバーに最小化アイコンが表示
- バックグラウンドで動作

#### Start in System Tray（システムトレイで起動）
- アプリケーションがシステムトレイに直接起動
- タスクバーにアイコンが表示されない
- 完全にバックグラウンドで動作

### 相互排他設定
- **Start Minimized**と**Start in System Tray**は同時に選択できません
- 一方を選択すると他方は自動的に無効化されます
- これは、起動時の動作を明確にするための設計です

## 🔄 システムトレイ常駐設定

### Always Resident in System Tray
このオプションを有効にすると、アプリケーションがシステムトレイに常駐します。

#### 機能
- アプリケーションがバックグラウンドで継続動作
- システムトレイアイコンからアクセス可能
- メインウィンドウを閉じてもアプリケーションは終了しない

#### 使用方法
1. システムトレイアイコンを右クリック
2. コンテキストメニューから操作を選択：
   - **Show**: メインウィンドウを表示
   - **Options**: オプションダイアログを開く
   - **Exit**: アプリケーションを終了

#### 設定方法
1. オプションダイアログを開く（`O`キー）
2. 「Startup」タブを選択
3. 「Always Resident in System Tray」をチェック
4. 「OK」をクリックして保存

### システムトレイアイコンのカスタマイズ
- システムトレイアイコンは自動的に設定されます
- アプリケーションのアイコンが使用されます
- カスタムアイコンの設定は現在サポートされていません

## ⏰ 起動遅延設定

### Startup Delay（起動遅延）
アプリケーションの起動を指定した秒数だけ遅延させることができます。

#### 設定方法
1. 「Startup」タブを選択
2. 「Startup Delay」フィールドに秒数を入力（0-60秒）
3. 「OK」をクリックして保存

#### 使用例
- **0秒**: 即座に起動（デフォルト）
- **3秒**: 3秒後に起動
- **10秒**: 10秒後に起動

#### 用途
- システム起動時の負荷分散
- 他のアプリケーションの起動完了を待つ
- ユーザーの準備時間を確保

## 📢 起動メッセージ設定

### Startup Message（起動メッセージ）
アプリケーション起動時に表示するメッセージを設定できます。

#### 設定方法
1. 「Startup」タブを選択
2. 「Startup Message」フィールドにメッセージを入力
3. 「OK」をクリックして保存

#### メッセージの例
```
BrowserChooser3 v0.1.0 が起動しました
システムトレイに常駐しています
```

#### プレースホルダー
- `{version}`: アプリケーションバージョン
- `{date}`: 現在の日付
- `{time}`: 現在の時刻

## 🔧 自動起動設定

### Windows起動時の自動起動
BrowserChooser3をWindows起動時に自動的に起動させる方法を説明します。

#### 方法1: スタートアップフォルダ
1. `Win + R`を押して「shell:startup」と入力
2. スタートアップフォルダを開く
3. `BrowserChooser3.exe`へのショートカットを作成

#### 方法2: タスクスケジューラー
1. タスクスケジューラーを開く
2. 「基本タスクの作成」をクリック
3. 以下の設定を行う：
   - **名前**: BrowserChooser3 Auto Start
   - **トリガー**: ログオン時
   - **アクション**: プログラムの開始
   - **プログラム**: `C:\Path\To\BrowserChooser3.exe`

#### 方法3: レジストリ設定
```reg
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]
"BrowserChooser3"="C:\\Path\\To\\BrowserChooser3.exe"
```

### 自動起動時の設定
自動起動時には以下の設定が推奨されます：

#### 推奨設定
- **Start in System Tray**: 有効化
- **Always Resident in System Tray**: 有効化
- **Startup Delay**: 5-10秒
- **Startup Message**: 設定（オプション）

#### 設定例
```
起動モード: Start in System Tray
システムトレイ常駐: 有効
起動遅延: 5秒
起動メッセージ: BrowserChooser3 が自動起動しました
```

## 🎯 起動設定の最適化

### 用途別の推奨設定

#### 個人使用
```
起動モード: Normal
システムトレイ常駐: 無効
起動遅延: 0秒
自動起動: 無効
```

#### 業務使用
```
起動モード: Start in System Tray
システムトレイ常駐: 有効
起動遅延: 3秒
自動起動: 有効
```

#### 開発・テスト
```
起動モード: Normal
システムトレイ常駐: 無効
起動遅延: 0秒
自動起動: 無効
起動メッセージ: 開発モードで起動
```

### パフォーマンス最適化

#### 起動時間の短縮
- 起動遅延を0秒に設定
- 不要な起動メッセージを無効化
- システムトレイ常駐を無効化

#### メモリ使用量の最適化
- システムトレイ常駐を有効化
- メインウィンドウを閉じる
- バックグラウンド動作を活用

## 🔍 起動設定の確認

### 現在の設定確認
1. オプションダイアログを開く（`O`キー）
2. 「Startup」タブを選択
3. 現在の設定を確認

### 設定ファイルの確認
設定は`BrowserChooser3Config.xml`に保存されます：

```xml
<StartupSettings>
  <StartupMode>SystemTray</StartupMode>
  <AlwaysResidentInSystemTray>true</AlwaysResidentInSystemTray>
  <StartupDelay>5</StartupDelay>
  <StartupMessage>BrowserChooser3 が起動しました</StartupMessage>
</StartupSettings>
```

## 🚨 トラブルシューティング

### よくある問題

#### システムトレイに表示されない
**原因**:
- システムトレイの設定が無効
- アイコンが非表示に設定されている
- アプリケーションが正常に起動していない

**解決策**:
1. システムトレイの設定を確認
2. アプリケーションを再起動
3. 設定をリセット

#### 自動起動しない
**原因**:
- スタートアップフォルダの設定が間違っている
- タスクスケジューラーの設定が間違っている
- レジストリの設定が間違っている

**解決策**:
1. 自動起動設定を確認
2. パスが正しいか確認
3. 管理者権限で実行

#### 起動遅延が動作しない
**原因**:
- 設定値が正しくない
- アプリケーションが正常に起動していない

**解決策**:
1. 起動遅延の設定値を確認
2. アプリケーションを再起動
3. ログを確認

### デバッグ方法

#### ログの確認
1. 「Other」タブでログを有効化
2. アプリケーションを起動
3. ログファイルを確認

#### 手動テスト
1. 設定を変更
2. アプリケーションを再起動
3. 動作を確認

## 💡 ベストプラクティス

### 起動設定の管理
- 用途に応じて適切な設定を選択
- 定期的に設定を見直し
- パフォーマンスを考慮した設定

### システムトレイ常駐の活用
- バックグラウンド動作を活用
- メインウィンドウを閉じてメモリを節約
- システムトレイから素早くアクセス

### 自動起動の設定
- 必要な場合のみ自動起動を有効化
- 起動遅延でシステム負荷を分散
- 起動メッセージで状態を確認

---

*より詳細な設定については、[設定ガイド](Configuration-Guide)をご覧ください。*
